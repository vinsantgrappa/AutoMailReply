
# 自動メール返信アプリケーション

## 概要

このアプリケーションは、**サイボウズメールの自動管理**を目的として設計されたツールです。  
受信メールをPDF出力する既存のプロセスと連携し、メールの自動返信や添付ファイルのダウンロード、PDF解析を一元的に処理します。  
担当者不在時でも迅速な対応を可能にし、業務全体の柔軟性と効率性を向上させました。

---

## 制作背景

### 業務上の課題
日々の業務において、メールを効率的に処理する必要がありましたが、以下の課題に直面していました：
1. **担当者の不在時に発生する顧客対応の遅延や漏れ**  
   担当者が外出や休暇で不在の場合、メールの返信が遅れることで顧客満足度が低下するリスクがありました。

2. **メール管理の属人化**  
   メール対応は各担当者のアカウントで行われており、他のメンバーが対応するにはパスワードやメールの履歴を共有する必要があり、非効率でした。

3. **煩雑なプロセス**  
   メール本文から情報を手動で抽出したり、返信や添付ファイルのダウンロードを個別に行うため、手間がかかっていました。

### 解決のためのアイデア
これらの課題を解決するために、**既存の受信メールPDF出力プロセス**を基盤とし、社内全員が共通して利用できる自動返信プログラムを構築することを目指しました。このプログラムのコンセプトは以下の通りです：

1. **共通プラットフォームの構築**  
   社内の全メンバーが、暗号化されたログイン情報を用いて簡単にメールアカウントにアクセス可能。これにより、特定の担当者に依存しない柔軟な体制を実現。

2. **メール対応の完全自動化**  
   PDF解析により必要な情報を抽出し、メールの返信や添付ファイルのダウンロードを効率化。

3. **迅速な顧客対応**  
   メール対応スピードを向上させることで、顧客満足度の向上と対応漏れの防止を実現。

---

## 主な機能

- **メール自動返信機能**  
  条件に一致するメールを検出し、定型文を挿入して自動返信します。
- **添付ファイルの自動ダウンロード**  
  メール本文中のリンクから暗号化されたファイルを自動的にダウンロードします。
- **PDF解析機能**  
  PDFからアカウント情報（メールアドレス、パスワードなど）を抽出します。
- **動作状況の可視化**  
  処理状況をリアルタイムでGIFアニメーションとして表示します。


## 動作デモ

### 自動ログインとメール返信、ダウンロード
以下のGIFが動作例です：
![process_demo](https://github.com/user-attachments/assets/38245ac2-ed8f-44a0-ba54-ddf08feff653)

---

## モジュール構成

### **1. `config_loader.py`**
- **役割**:  
  暗号化された設定ファイルを復号化し、以下の情報を管理します。
  - サイボウズメールのログインIDとパスワード。
  - 利用者ごとのプロファイルデータ。
- **主な機能**:
  - 設定ファイルの暗号化・復号化（AES）。
  - ユーザーを特定し、適切な設定を提供。

---

### **2. `web_driver.py`**
- **役割**:  
  Seleniumで使用するChromeDriverを管理し、ブラウザ操作の基盤を提供します。
- **主な機能**:
  - ChromeDriverの多重起動防止。
  - プロセス管理と終了処理。
  - 最新のChromeDriverの自動更新。

---

### **3. `main_process.py`**
- **役割**:  
  アプリ全体のエントリーポイントとして、各モジュールを統合して動作させます。
- **主な機能**:
  - GUI（Tkinter）を提供。
  - PDFファイルのドラッグ＆ドロップ機能。
  - 自動返信と添付ダウンロード処理の管理。

---

### **4. `reply_manager.py`**
- **役割**:  
  メールリストから特定条件に一致するメールを検出し、自動返信または添付ファイルをダウンロードします。
- **主な機能**:
  - メールタイトルのマッチング処理。
  - 自動返信文の挿入と送信。
  - 暗号化された添付ファイルのダウンロード。

---

### **5. `gif_player.py`**
- **役割**:  
  処理状況を示すGIFアニメーションの再生と管理。
- **主な機能**:
  - Tkinter上でGIFアニメーションを再生。
  - 処理の進捗に応じたGIFの切り替え。

---

### **6. `move_manager.py`**
- **役割**:  
  処理状況に応じたアニメーションの制御を担当。
- **主な機能**:
  - GIFアニメーションの停止と再生。
  - スタンバイや処理中状態への切り替え。

---

### **7. `adjust_data_info.py`**
- **役割**:  
  メールの受信日時情報を日本時間に補正。
- **主な機能**:
  - タイムゾーン補正とデータ整形。
  - メール情報の辞書化。

---

### **8. `find_editable_contents.py`**
- **役割**:  
  メール返信画面で編集可能なエリアを検出。
- **主な機能**:
  - Seleniumを使用してTinyMCEエディタやテキストエリアを検索。
  - フレーム内要素への対応。

---

## 費用対効果

このアプリケーションを導入することで、以下のようなコスト削減と業務効率化が期待できます。

### **前提条件**
1. **1か月あたりの受信メール仮定件数**: 約600～1000件  
2. **対応時間の短縮**: 自動化により 1件あたり約**2～3分** 
3. **平均時給**: **2000円/時**（令和2年度厚生労働白書より）  

---

### **コスト削減効果**
#### **1. 月間削減時間**
- **手作業の対応時間**: 平均5分/件  
- **自動化による短縮時間**: **3分/件（0.05時間/件）**  
- 月間削減時間: **600～1000件 × 0.05時間 = 30～50時間**  

#### **2. 金額換算**
- 削減時間 × 平均時給:  
  **30～50時間 × 2000円/時 = 6万～10万円/月**  

---

### **その他の効果**
1. **顧客対応の迅速化**  
   - 対応漏れ防止で顧客満足度を向上。  
   - 担当者不在時の柔軟な対応を可能に。  
2. **業務負担の分散**  
   - 誰でもメール対応が可能になり、属人化を解消。  
3. **ミスの削減**  
   - 定型文による返信でヒューマンエラーを防止。  

---

## 使用技術

- **Python**: アプリケーション全体のロジックを構築。
- **Selenium**: ブラウザ操作の自動化を実現。
- **Tkinter**: GUIを提供。
- **pdfminer.six**: PDF解析とデータ抽出を担当。
- **WebDriver Manager**: ChromeDriverの管理を簡素化。
- **Cryptography**: 暗号化処理を通じてログイン情報を安全に管理。

---

## 注意事項

- **ポートフォリオの一環としての位置づけ**  
  このプロジェクトは実務で使用されたツールを参考に再設計したものであり、全ユーザーが使用可能な状態ではありません。
- **HTML構造の依存**  
  メールサービスのHTML構造が変更された場合、動作に影響を与える可能性があります。
